---
import BlogList from "../../components/blocks/BlogList";
import Footer from "../../layouts/Footer.astro";
import SimpleNavbar from "../../layouts/SimpleNavbar.astro";
import { getCollection } from "astro:content";

const entries = await getCollection("blog");
const posts = entries.map((entry) => {
    const d = entry.data as any;
    const photo = typeof d.cover === "string" ? d.cover : d.cover?.src ?? "";
    const tags = Array.isArray(d.tags) ? d.tags : d.tags ? [d.tags] : [];
    const content =
        typeof d.body === "string"
            ? d.body
            : typeof entry.body === "string"
              ? entry.body
              : entry.body
                ? String(entry.body)
                : "";

    return {
        id: String(entry.slug),
        title: d.title ?? "Untitled",
        photo,
        tags,
        content,
        href: `/blog/${entry.slug}`,
        publishDate: d.publishDate ?? null,
    };
});
---

<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <title>California Residence - Blog</title>
    </head>
    <body>
        <SimpleNavbar />
        <main class="container mx-auto px-4 sm:px-6 lg:px-8 py-12 md:py-20">
            <div class="text-center mb-12">
                <p class="text-[#94792F] font-semibold mb-2">Our Blog</p>
                <h2
                    class="text-4xl md:text-5xl font-italiana font-extrabold tracking-tight text-[#1b3942]"
                >
                    Insights &amp; Inspiration
                </h2>
                <p class="mt-4 text-lg text-[#102227]/70 max-w-2xl mx-auto">
                    Explore our latest articles and updates on the real estate
                    market, home design, and community living.
                </p>
            </div>
            <BlogList posts={posts} client:load />
        </main>
        <Footer />
    </body>
</html>
